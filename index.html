<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório Membresia</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #f4f4f4;
        }

        h1 {
            text-align: center;
            font-size: 2em;
            margin: 20px 0;
            background-color: #1E88E5;
            padding: 20px;
            color: #f4f4f4;

        }

        form {
            width: 90%;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
        }

        input[type="submit"] {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            width: 100%;
        }

        input[type="submit"]:hover {
            background-color: #45a049;
        }

        #exportButton {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            font-size: 1em;
            width: 90%;
            max-width: 600px;
        }

        #exportButton:hover {
            background-color: #1E88E5;
        }

        table {
            width: 90%;
            max-width: 600px;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 12px;
            text-align: center;
            font-size: 1em;
        }

        th {
            background-color: #f2f2f2;
        }

        .total {
            font-weight: bold;
        }

        .deleteButton {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .deleteButton:hover {
            background-color: #e53935;
        }

        /* Media Queries para dispositivos móveis */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.5em;
            }

            form, #exportButton, table {
                width: 100%;
                margin: 10px auto;
            }

            th, td {
                padding: 10px;
                font-size: 0.9em;
            }

            input[type="submit"], #exportButton {
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <h1>Relatório de Quantidade de Pessoas no ARENA</h1>

    <!-- Formulário para registrar nova equipe -->
    <form id="registerForm">
        <label for="nomeEquipe">Nome da sub:</label>
        <input type="text" id="nomeEquipe" required>

        <label for="quantidadePessoas">Quantidade de Pessoas:</label>
        <input type="number" id="quantidadePessoas" required min="1">

        <input type="submit" value="Registrar">
    </form>

    <table id="reportTable">
        <thead>
            <tr>
                <th>SUB</th>
                <th>Quantidade de Pessoas</th>
                <th>Ação</th>
            </tr>
        </thead>
        <tbody>
            <!-- Os dados serão inseridos aqui -->
        </tbody>
        <tfoot>
            <tr>
                <td>TOTAL</td>
                <td id="totalPessoas" class="total">0</td>
                <td></td>
            </tr>
        </tfoot>
    </table>

    <!-- Botão para exportar PDF -->
    <button id="exportButton">Exportar Relatório em PDF</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script>
        let equipes = [];

        // Função para carregar as equipes do localStorage
        function carregarEquipes() {
            const equipesSalvas = localStorage.getItem("equipes");
            if (equipesSalvas) {
                equipes = JSON.parse(equipesSalvas);
            }
        }

        // Função para salvar as equipes no localStorage
        function salvarEquipes() {
            localStorage.setItem("equipes", JSON.stringify(equipes));
        }

        // Função para preencher a tabela com os dados das equipes
        function preencherTabela() {
            const tbody = document.querySelector("#reportTable tbody");
            tbody.innerHTML = ""; // Limpa a tabela antes de preencher
            let total = 0;

            equipes.forEach((equipe, index) => {
                const tr = document.createElement("tr");

                const tdNome = document.createElement("td");
                tdNome.textContent = equipe.nome;

                const tdQuantidade = document.createElement("td");
                tdQuantidade.textContent = equipe.quantidade;

                const tdAcao = document.createElement("td");
                const deleteButton = document.createElement("button");
                deleteButton.textContent = "Excluir";
                deleteButton.className = "deleteButton";
                deleteButton.onclick = () => excluirEquipe(index);
                tdAcao.appendChild(deleteButton);

                tr.appendChild(tdNome);
                tr.appendChild(tdQuantidade);
                tr.appendChild(tdAcao);

                tbody.appendChild(tr);

                total += equipe.quantidade;
            });

            document.getElementById("totalPessoas").textContent = total;
        }

        // Função para adicionar nova equipe
        function adicionarEquipe(nome, quantidade) {
            equipes.push({ nome, quantidade: parseInt(quantidade) });
            salvarEquipes(); // Salva a nova equipe
            preencherTabela();
        }

        // Função para excluir uma equipe
        function excluirEquipe(index) {
            equipes.splice(index, 1); // Remove a equipe pelo índice
            salvarEquipes(); // Salva as mudanças
            preencherTabela(); // Recarrega a tabela
        }

        // Manipula o evento de envio do formulário
        document.getElementById("registerForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Previne o envio padrão do formulário

            const nomeEquipe = document.getElementById("nomeEquipe").value;
            const quantidadePessoas = document.getElementById("quantidadePessoas").value;

            adicionarEquipe(nomeEquipe, quantidadePessoas);

            // Limpa os campos do formulário após adicionar a equipe
            document.getElementById("nomeEquipe").value = "";
            document.getElementById("quantidadePessoas").value = "";
        });

        // Função para exportar o relatório em PDF
        document.getElementById("exportButton").addEventListener("click", function() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(18);
            doc.text("Relatório de Quantidade de Pessoas no ARENA", 14, 22);

            let startY = 30;

            equipes.forEach((equipe, index) => {
                doc.text(`${index + 1}. ${equipe.nome}: ${equipe.quantidade} pessoas`, 14, startY);
                startY += 10;
            });

            const totalPessoas = document.getElementById("totalPessoas").textContent;
            doc.text(`Total de Pessoas: ${totalPessoas}`, 14, startY + 10);

            doc.save("relatorio-atos-ARENA.pdf");
        });

        // Carrega as equipes salvas no localStorage e preenche a tabela
        carregarEquipes();
        preencherTabela();
    </script>
</body>
</html>
